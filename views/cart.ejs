<%- include('./partials/header') %>
<div class="w-full h-screen flex items-start px-20 py-20 gap-10">
    <% if (cart.length === 0) { %>
        <div class="w-full text-center py-20">
            <h2 class="text-2xl font-semibold">Your cart is empty</h2>
            <p class="mt-2 text-gray-600">Add some items to your cart to see them here.</p>
            <a href="/shop" class="mt-5 inline-block px-6 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition duration-150 ease-in-out">
                Browse Products
            </a>
        </div>
    <% } else { %>
        <div class="w-[27%] rounded-md overflow-hidden">
            <% cart.forEach(function(item) { %>
            <div class="mb-5">
                <div class="w-full h-52 flex items-center justify-center" style="background-color: #<%= item.itemId.bgcolor %>;">
                    <img class="max-h-full max-w-full object-contain" src="data:image/jpeg;base64,<%= item.itemId.image.toString('base64') %>" alt="Product Image">
                </div>
                <div class="w-full flex justify-between px-5 py-4" style="background-color: #<%= item.itemId.panelcolor %>; color: #<%= item.itemId.textcolor %>;">
                    <h3 class="text-2xl"><%= item.itemId.name %></h3>
                    <form action="/cart/update/<%= item.itemId._id %>" method="POST" class="flex items-center gap-2">
                        <button type="submit" name="action" value="decrease" class="w-7 h-7 bg-white flex rounded-full items-center justify-center hover:bg-gray-200 transition duration-150 ease-in-out ri-subtract-line"></button>
                        <div class="px-2 py-1 rounded-md bg-white text-black"><%= item.quantity %></div>
                        <button type="submit" name="action" value="increase" class="w-7 h-7 bg-white flex rounded-full items-center justify-center hover:bg-gray-200 transition duration-150 ease-in-out ri-add-line"></button>
                    </form>
                    <form action="/cart/remove/<%= item.itemId._id %>" method="POST">
                        <button type="submit" class="text-red-600 font-semibold hover:text-red-800 transition duration-150 ease-in-out">Remove</button>
                    </form>
                </div>
                <div class="flex items-center justify-between px-5 py-3" style="background-color: #<%= item.itemId.panelcolor %>; color: #<%= item.itemId.textcolor %>;">
                    <h4 class="text-lg">Net Total</h4>
                    <h2 class="text-lg">₹ <%= (item.itemId.price * item.quantity) - (item.itemId.price * item.quantity * (item.itemId.discount / 100)) %></h2>
                </div>
            </div>
            <% }) %>
        </div>
        <div class="w-[70%]">
            <h3 class="text-xl">Price Breakdown</h3>
            <div class="px-10 mt-5">
                <div class="flex mt-2">
                    <h4 class="w-1/3">Total MRP</h4>
                    <h4>₹ <%= cart.reduce((total, item) => total + (item.itemId.price * item.quantity), 0) %></h4>
                </div>
                <div class="flex mt-2">
                    <h4 class="w-1/3">Discount on MRP</h4>
                    <h4>₹ <%= cart.reduce((total, item) => total + (item.itemId.price * item.quantity * (item.itemId.discount / 100)), 0) %></h4>
                </div>
                <div class="flex mt-2">
                    <h4 class="w-1/3">Platform Fee</h4>
                    <h4>₹ 20</h4>
                </div>
                <div class="flex mt-2">
                    <h4 class="w-1/3">Shipping Fee</h4>
                    <h4>FREE</h4>
                </div>
            </div>
            <div class="w-full h-[1px] bg-black mt-10"></div>
            <div class="flex mt-5">
                <h3 class="w-1/3 text-xl">Total Amount</h3>
                <h3 class="font-semibold text-xl text-green-600">₹ <%= cart.reduce((total, item) => total + (item.itemId.price * item.quantity) - (item.itemId.price * item.quantity * (item.itemId.discount / 100)), 0) + 20 %></h3>
            </div>
            <form action=""></form>
        </div>
    <% } %>
</div>
<%- include('./partials/footer') %>
